<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WhatsApp Archive Viewer (Demo API)</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#f5f5f7}
    .wrap{max-width:900px;margin:0 auto;padding:24px}
    .card{background:#fff;border-radius:16px;padding:18px;box-shadow:0 8px 24px rgba(0,0,0,.08)}
    label{display:block;font-size:14px;color:#333;margin:12px 0 6px}
    input[type="text"],input[type="file"]{width:100%;padding:10px;border:1px solid rgba(0,0,0,.18);border-radius:10px}
    button{margin-top:14px;padding:10px 14px;border-radius:12px;border:0;background:#0071e3;color:#fff;font-weight:600;cursor:pointer}
    pre{white-space:pre-wrap;background:#0b1020;color:#d7e0ff;border-radius:14px;padding:14px;overflow:auto}
    .hint{color:#555;font-size:13px;line-height:1.45}
  </style>
</head>
<body>
  <div class="wrap">
    <h1 style="margin:0 0 12px">WhatsApp Archive Viewer (Backend Demo)</h1>
    <p class="hint">Upload a <b>.txt</b> export or a <b>.zip</b> exported by WhatsApp (where the ZIP contains a .txt). This demo API returns parsed messages as JSON. Media binaries are not served in this backend demo (dev team can add later).</p>

    <div class="card">
      <label>Your name (optional, for outgoing detection)</label>
      <input id="myName" type="text" placeholder="e.g. Syed Ali" />

      <label>WhatsApp export (.txt or .zip)</label>
      <input id="file" type="file" />

      <button id="btn">Upload & Parse</button>

      <div style="height:12px"></div>
      <pre id="out">Waiting…</pre>
    </div>
  </div>

<script>
  const btn = document.getElementById('btn');
  const out = document.getElementById('out');

  btn.addEventListener('click', async () => {
    const f = document.getElementById('file').files[0];
    const myName = document.getElementById('myName').value;
    if(!f){ out.textContent = 'Please choose a file first.'; return; }

    const fd = new FormData();
    fd.append('file', f);
    if(myName) fd.append('myName', myName);

    out.textContent = 'Uploading…';
    const res = await fetch('/api/upload', { method: 'POST', body: fd });
    const text = await res.text();

    try {
      out.textContent = JSON.stringify(JSON.parse(text), null, 2);
    } catch(e){
      out.textContent = text;
    }
  });
</script>
</body>
</html>
